<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WH á€…á€®á€™á€¶á€á€”á€·á€ºá€á€½á€²á€á€°</title>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <style>
        :root { --main: #00ff88; --glass: rgba(255, 255, 255, 0.05); }
        body { background: #0a0e17; color: white; font-family: sans-serif; margin: 0; padding: 15px; }
        
        /* Password á€™á€»á€€á€ºá€”á€¾á€¬á€•á€¼á€„á€º */
        #loginOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #0a0e17; display: flex; align-items: center; justify-content: center; z-index: 1000; }
        .login-card { background: var(--glass); padding: 30px; border-radius: 30px; border: 1px solid rgba(255,255,255,0.1); backdrop-filter: blur(15px); text-align: center; width: 85%; }
        
        /* Custom Alert á€’á€®á€‡á€­á€¯á€„á€ºá€¸ */
        .custom-alert { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2000; align-items: center; justify-content: center; }
        .alert-box { background: #1a1f2b; padding: 25px; border-radius: 25px; border: 1px solid var(--main); text-align: center; width: 80%; }
        
        /* Admin á€’á€®á€‡á€­á€¯á€„á€ºá€¸á€™á€»á€¬á€¸ */
        .admin-content { display: none; }
        .tab-box { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab-btn { flex: 1; padding: 15px; border: none; border-radius: 15px; background: var(--glass); color: #aaa; font-weight: bold; }
        .tab-btn.active { background: var(--main); color: #000; }
        .section { background: var(--glass); padding: 20px; border-radius: 25px; border: 1px solid rgba(255,255,255,0.1); display: none; }
        .section.active { display: block; }
        input { width: 100%; padding: 15px; margin: 10px 0; border-radius: 15px; border: 1px solid #333; background: rgba(0,0,0,0.3); color: white; box-sizing: border-box; }
        .btn { width: 100%; padding: 15px; border-radius: 15px; border: none; font-weight: bold; margin-top: 10px; }
        .add-btn { background: var(--main); color: #000; }
        .del-btn { background: #ff4444; color: white; padding: 8px 15px; border-radius: 10px; border:none; cursor:pointer; }
        .item-card { background: rgba(255,255,255,0.03); border: 1px solid #222; padding: 15px; border-radius: 15px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; }
    </style>
</head>
<body>

    <div id="loginOverlay">
        <div class="login-card">
            <h2 style="color: var(--main);">á€œá€»á€¾á€­á€¯á€·á€á€¾á€€á€ºá€”á€¶á€•á€«á€á€º</h2>
            <input type="password" id="pwInput" placeholder="á€›á€­á€¯á€€á€ºá€‘á€Šá€·á€ºá€•á€«...">
            <button class="btn add-btn" onclick="checkPw()">á€¡á€á€Šá€ºá€•á€¼á€¯á€™á€Šá€º</button>
        </div>
    </div>

    <div id="customAlert" class="custom-alert">
        <div class="alert-box">
            <p id="alertMsg" style="font-size: 1.1rem; margin-bottom: 20px;"></p>
            <div id="alertBtns" style="display: flex; gap: 10px;"></div>
        </div>
    </div>

    <div class="admin-content" id="adminPanel">
        <h2 style="text-align: center; color: var(--main);">WH á€…á€®á€™á€¶á€á€”á€·á€ºá€á€½á€²á€á€°</h2>
        <div class="tab-box">
            <button id="b1" class="tab-btn active" onclick="showTab('upload')">á€•á€…á€¹á€…á€Šá€ºá€¸á€á€„á€º/á€–á€»á€€á€º</button>
            <button id="b2" class="tab-btn" onclick="showTab('orders')">á€¡á€±á€¬á€ºá€’á€«á€™á€»á€¬á€¸</button>
        </div>

        <div id="upload" class="section active">
            <input type="text" id="pName" placeholder="á€•á€…á€¹á€…á€Šá€ºá€¸á€¡á€™á€Šá€º">
            <input type="number" id="pPrice" placeholder="á€ˆá€±á€¸á€”á€¾á€¯á€”á€ºá€¸">
            <input type="text" id="pImg" placeholder="á€•á€¯á€¶á€œá€„á€·á€ºá€á€º">
            <button class="btn add-btn" onclick="uploadProduct()">á€•á€…á€¹á€…á€Šá€ºá€¸á€¡á€á€…á€ºá€á€„á€ºá€™á€Šá€º</button>
            <hr style="opacity:0.1; margin: 20px 0;">
            <div id="adminProductList">á€†á€½á€²á€šá€°á€”á€±á€á€Šá€º...</div>
        </div>

        <div id="orders" class="section">
            <div id="adminOrderList">á€¡á€±á€¬á€ºá€’á€«á€™á€»á€¬á€¸ á€†á€½á€²á€šá€°á€”á€±á€á€Šá€º...</div>
        </div>
    </div>

    <script>
        const correctPw = "131019";
        const firebaseConfig = {
            apiKey: "AIzaSyBU4Q9G2eyigNWyZVT_dabEFG4fuslwTW4",
            authDomain: "online-shop-wh.firebaseapp.com",
<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‘‘ WH PRO ADMIN</title>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <style>
        :root { --gold: #d4af37; --emerald: #10b981; --bg: #061f18; --card: #0a2e24; --text: #ffffff; }
        body { background: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; margin: 0; padding: 15px; text-align: center; }
        #toast { position: fixed; top: -100px; left: 50%; transform: translateX(-50%); background: linear-gradient(45deg, var(--gold), #aa771c); color: #000; padding: 15px 30px; border-radius: 50px; font-weight: bold; transition: 0.5s; z-index: 30000; box-shadow: 0 5px 20px rgba(0,0,0,0.4); border: 1px solid #fff; }
        #loginOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); display: flex; align-items: center; justify-content: center; z-index: 20000; }
        .login-box { background: var(--card); padding: 30px; border-radius: 20px; border: 2px solid var(--gold); width: 85%; max-width: 350px; }
        .tab-box { display: flex; gap: 8px; margin: 20px 0; }
        .tab-btn { flex: 1; padding: 12px 5px; border: 1px solid var(--emerald); border-radius: 12px; background: transparent; color: var(--emerald); font-weight: bold; cursor: pointer; font-size: 13px; }
        .tab-btn.active { background: var(--emerald); color: #000; box-shadow: 0 0 15px var(--emerald); }
        .section { background: var(--card); padding: 25px; border-radius: 20px; border: 1px solid rgba(212,175,55,0.2); margin-bottom: 20px; }
        input, textarea { width: 100%; padding: 14px; margin: 10px 0; border: 1px solid #1a4d3f; border-radius: 10px; background: #041611; color: #fff; box-sizing: border-box; outline: none; }
        .add-btn { background: linear-gradient(90deg, var(--emerald), var(--gold)); color: #000; width: 100%; border: none; padding: 16px; border-radius: 12px; font-weight: bold; cursor: pointer; }
        .card { background: #08261e; border-left: 5px solid var(--gold); padding: 15px; border-radius: 12px; margin-top: 15px; text-align: left; position: relative; color: #fff; font-size: 0.9rem; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .item { background: #08261e; padding: 10px; border-radius: 15px; border: 1px solid #1a4d3f; text-align: center; color: #fff; }
        .item img { width: 100%; height: 100px; object-fit: cover; border-radius: 10px; }
        .del-btn { background: #5a0000; color: #fff; border: none; padding: 8px; border-radius: 8px; width: 100%; margin-top: 10px; cursor: pointer; font-size: 11px; }
        .hidden { display: none; }
        #status { font-size: 13px; color: var(--emerald); display: none; margin-bottom: 10px; font-weight: bold; }
    </style>
</head>
<body>

    <div id="loginOverlay">
        <div class="login-box">
            <h3>ğŸ” Admin Login</h3>
            <input type="password" id="adminPw" placeholder="á€…á€€á€¬á€¸á€á€¾á€€á€º á€›á€­á€¯á€€á€ºá€‘á€Šá€·á€ºá€•á€«">
            <button class="add-btn" onclick="checkLogin()">á€á€„á€ºá€™á€Šá€º</button>
        </div>
    </div>

    <div id="toast"></div>
    <h2>ğŸ‘‘ WH PRO ADMIN</h2>

    <div class="tab-box">
        <button id="t1" class="tab-btn active" onclick="switchTab('upload')">á€•á€…á€¹á€…á€Šá€ºá€¸á€á€„á€ºá€›á€”á€º</button>
        <button id="t2" class="tab-btn" onclick="switchTab('orders')">á€¡á€±á€¬á€ºá€’á€«á€…á€…á€ºá€›á€”á€º</button>
        <button id="t3" class="tab-btn" onclick="switchTab('manage')">á€…á€¬á€›á€„á€ºá€¸á€–á€»á€€á€ºá€›á€”á€º</button>
    </div>

    <div id="uploadSection" class="section">
        <input type="text" id="pName" placeholder="á€•á€…á€¹á€…á€Šá€ºá€¸á€¡á€™á€Šá€º">
        <input type="number" id="pPrice" placeholder="á€ˆá€±á€¸á€”á€¾á€¯á€”á€ºá€¸">
        <textarea id="pDetail" placeholder="á€¡á€á€±á€¸á€…á€­á€á€ºá€¡á€á€»á€€á€ºá€¡á€œá€€á€º" rows="3"></textarea>
        <div style="text-align:left; font-size:12px; color:var(--gold);">ğŸ“¸ á€•á€…á€¹á€…á€Šá€ºá€¸á€•á€¯á€¶ (Required)</div>
        <input type="file" id="pImgFile" accept="image/*">
        <div style="text-align:left; font-size:12px; color:var(--gold);">ğŸ¥ á€—á€®á€’á€®á€šá€­á€¯ (Optional)</div>
        <input type="file" id="pVidFile" accept="video/*">
        <div id="status">â³ á€á€„á€ºá€”á€±á€á€Šá€º... á€á€á€…á€±á€¬á€„á€·á€ºá€•á€« á€†á€›á€¬</div>
        <button id="addBtn" class="add-btn" onclick="uploadAll()">Add to Shop</button>
    </div>

    <div id="orderSection" class="section hidden">
        <h3 style="color:var(--gold)">ğŸ“‹ á€œá€€á€ºá€á€¶á€›á€›á€¾á€­á€á€±á€¬ á€¡á€±á€¬á€ºá€’á€«á€™á€»á€¬á€¸</h3>
        <div id="orderList">á€¡á€±á€¬á€ºá€’á€«á€™á€»á€¬á€¸ á€†á€½á€²á€šá€°á€”á€±á€á€Šá€º...</div>
    </div>

    <div id="manageSection" class="section hidden">
        <h3 style="color:var(--gold)">ğŸ“¦ á€•á€…á€¹á€…á€Šá€ºá€¸á€…á€¬á€›á€„á€ºá€¸ á€…á€®á€™á€¶á€›á€”á€º</h3>
        <div id="productList" class="grid">á€•á€…á€¹á€…á€Šá€ºá€¸á€™á€»á€¬á€¸ á€†á€½á€²á€šá€°á€”á€±á€á€Šá€º...</div>
    </div>

    <script>
        const firebaseConfig = { 
            apiKey: "AIzaSyBU4Q9G2eyigNWyZVT_dabEFG4fuslwTW4", 
            authDomain: "online-shop-wh.firebaseapp.com", 
            projectId: "online-shop-wh", 
            storageBucket: "online-shop-wh.firebasestorage.app", 
            messagingSenderId: "297839145890", 
            appId: "1:297839145890:web:f90f862b000e8631a4f8fb" 
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        const CLOUDINARY_NAME = "djw6jldfb"; 
        const CLOUDINARY_PRESET = "wh_premium_preset";

        function checkLogin() {
            if(document.getElementById('adminPw').value === "131019") {
                document.getElementById('loginOverlay').style.display = "none";
                showToast("ğŸ”“ á€€á€¼á€­á€¯á€†á€­á€¯á€•á€«á€á€šá€º á€†á€›á€¬!");
            } else { showToast("âš ï¸ á€…á€€á€¬á€¸á€á€¾á€€á€º á€™á€¾á€¬á€¸á€”á€±á€•á€«á€á€Šá€º"); }
        }

        function showToast(txt) {
            const t = document.getElementById('toast');
            t.innerText = txt; t.style.top = '30px';
            setTimeout(() => t.style.top = '-100px', 3000);
        }

        async function uploadAll() {
            const name = document.getElementById('pName').value;
            const price = document.getElementById('pPrice').value;
            const imgFile = document.getElementById('pImgFile').files[0];
            const vidFile = document.getElementById('pVidFile').files[0];
            if(!name || !price || !imgFile) return showToast("âš ï¸ á€¡á€á€»á€€á€ºá€¡á€œá€€á€º á€–á€¼á€Šá€·á€ºá€•á€« á€†á€›á€¬");

            const btn = document.getElementById('addBtn');
            const status = document.getElementById('status');
            btn.disabled = true; status.style.display = "block";
            let imgUrl = "", vidUrl = "";

            try {
                status.innerText = "â³ á€“á€¬á€á€ºá€•á€¯á€¶á€á€„á€ºá€”á€±á€•á€«á€á€Šá€º...";
                const imgData = new FormData();
                imgData.append("file", imgFile);
                imgData.append("upload_preset", CLOUDINARY_PRESET);
                const imgRes = await fetch(`https://api.cloudinary.com/v1_1/${CLOUDINARY_NAME}/image/upload`, { method: "POST", body: imgData });
                imgUrl = (await imgRes.json()).secure_url;

                if(vidFile) {
                    status.innerText = "â³ á€—á€®á€’á€®á€šá€­á€¯á€á€„á€ºá€”á€±á€•á€«á€á€Šá€º...";
                    const vidData = new FormData();
                    vidData.append("file", vidFile);
                    vidData.append("upload_preset", CLOUDINARY_PRESET);
                    const vidRes = await fetch(`https://api.cloudinary.com/v1_1/${CLOUDINARY_NAME}/video/upload`, { method: "POST", body: vidData });
                    vidUrl = (await vidRes.json()).secure_url;
                }

                await db.collection("products").add({
                    name, price, image_url: imgUrl, video_id: vidUrl || "",
                    detail: document.getElementById('pDetail').value,
                    time: firebase.firestore.FieldValue.serverTimestamp()
                });

                showToast("âœ… á€•á€…á€¹á€…á€Šá€ºá€¸á€á€„á€ºá€á€¼á€„á€ºá€¸ á€¡á€±á€¬á€„á€ºá€™á€¼á€„á€ºá€•á€«á€á€Šá€º!");
                setTimeout(() => location.reload(), 2000);
            } catch (e) {
                showToast("âŒ á€á€…á€ºá€á€¯á€á€¯ á€™á€¾á€¬á€¸á€šá€½á€„á€ºá€¸á€á€½á€¬á€¸á€•á€«á€á€Šá€º");
                btn.disabled = false; status.style.display = "none";
            }
        }

         function syncData() {
            // Orders Sync Fix
            db.collection("orders").orderBy("time", "desc").onSnapshot(snap => {
                let orderListDiv = document.getElementById('orderList');
                orderListDiv.innerHTML = ""; // á€¡á€Ÿá€±á€¬á€„á€ºá€¸á€á€½á€±á€€á€­á€¯ á€¡á€›á€„á€ºá€–á€»á€€á€º

                if (snap.empty) {
                    orderListDiv.innerHTML = "<div style='opacity:0.5; margin-top:20px;'>á€¡á€±á€¬á€ºá€’á€«á€™á€›á€¾á€­á€á€±á€¸á€•á€«á‹</div>";
                } else {
                    snap.forEach(doc => {
                        let o = doc.data();
                        let docId = doc.id; // Document ID á€€á€­á€¯ á€á€±á€á€»á€¬á€–á€™á€ºá€¸á€šá€°

                        let card = document.createElement('div');
                        card.className = "card";
                        card.innerHTML = `
                            <div style="color:var(--gold); font-weight:bold; border-bottom:1px solid #1a4d3f; padding-bottom:5px; margin-bottom:8px;">ğŸ“¦ ${o.product || 'á€¡á€™á€Šá€ºá€™á€›á€¾á€­á€•á€…á€¹á€…á€Šá€ºá€¸'}</div>
                            ğŸ‘¤ á€á€šá€ºá€á€°: ${o.customer || 'á€™á€á€­á€›'}<br>
                            ğŸ“ á€–á€¯á€”á€ºá€¸: ${o.phone || 'á€™á€›á€¾á€­'}<br>
                            ğŸ“ á€œá€­á€•á€ºá€…á€¬: ${o.address || 'á€™á€›á€¾á€­'}<br>
                            â° á€¡á€á€»á€­á€”á€º: <span style="font-size:11px; opacity:0.8; color:var(--emerald);">${o.time || '-'}</span><br>
                        `;

                        // á€–á€»á€€á€ºá€á€²á€·á€á€œá€¯á€á€ºá€€á€­á€¯ JS á€€á€”á€± á€á€­á€¯á€€á€ºá€›á€­á€¯á€€á€º Create á€œá€¯á€•á€ºá€•á€¼á€®á€¸ Function á€”á€²á€· á€á€»á€­á€á€º
                        let delBtn = document.createElement('button');
                        delBtn.className = "del-btn";
                        delBtn.innerText = "ğŸ—‘ï¸ á€¡á€±á€¬á€ºá€’á€«á€–á€»á€€á€ºá€™á€Šá€º";
                        delBtn.onclick = function() {
                            deleteDoc('orders', docId);
                        };

                        card.appendChild(delBtn);
                        orderListDiv.appendChild(card);
                    });
                }
            });

            // Products Sync
            db.collection("products").onSnapshot(snap => {
                let productListDiv = document.getElementById('productList');
                productListDiv.innerHTML = "";
                snap.forEach(doc => {
                    let p = doc.data();
                    let docId = doc.id;

                    let item = document.createElement('div');
                    item.className = "item";
                    item.innerHTML = `
                        <img src="${p.image_url}">
                        <div style="font-size:11px; margin:5px 0; font-weight:bold;">${p.name}</div>
                    `;

                    let delBtn = document.createElement('button');
                    delBtn.className = "del-btn";
                    delBtn.innerText = "ğŸ—‘ï¸ á€–á€»á€€á€ºá€™á€Šá€º";
                    delBtn.onclick = function() {
                        deleteDoc('products', docId);
                    };

                    item.appendChild(delBtn);
                    productListDiv.appendChild(item);
                });
            });
        }

        // á€–á€»á€€á€ºá€á€²á€· Function á€€á€­á€¯ á€•á€­á€¯á€•á€¼á€®á€¸ á€á€­á€€á€»á€¡á€±á€¬á€„á€º á€•á€¼á€„á€ºá€†á€„á€ºá€‘á€¬á€¸á€á€šá€º
        function deleteDoc(col, id) {
            if(confirm("á€’á€®á€¡á€±á€¬á€ºá€’á€«á€€á€­á€¯ á€–á€»á€€á€ºá€™á€¾á€¬ á€á€±á€á€»á€¬á€œá€¬á€¸ á€†á€›á€¬?")) {
                db.collection(col).doc(id).delete()
                .then(() => {
                    showToast("ğŸ—‘ï¸ á€’á€±á€á€¬á€€á€­á€¯ á€¡á€±á€¬á€„á€ºá€™á€¼á€„á€ºá€…á€½á€¬ á€–á€»á€€á€ºá€•á€¼á€®á€¸á€•á€«á€•á€¼á€®");
                })
                .catch((error) => {
                    console.error("Error removing document: ", error);
                    showToast("âŒ á€–á€»á€€á€ºá€œá€­á€¯á€·á€™á€›á€•á€« (Error á€á€€á€ºá€”á€±á€á€Šá€º)");
                });
            }
        }


        function switchTab(t) {
    // á€¡á€›á€„á€ºá€†á€¯á€¶á€¸ Section á€¡á€¬á€¸á€œá€¯á€¶á€¸á€€á€­á€¯ á€–á€»á€€á€ºá€‘á€¬á€¸á€™á€šá€º
    document.getElementById('uploadSection').classList.add('hidden');
    document.getElementById('orderSection').classList.add('hidden');
    document.getElementById('manageSection').classList.add('hidden');
    
    // Tab á€á€œá€¯á€á€ºá€á€½á€±á€›á€²á€· Active á€¡á€›á€±á€¬á€„á€ºá€€á€­á€¯ á€¡á€€á€¯á€”á€ºá€–á€¼á€¯á€á€ºá€™á€šá€º
    document.getElementById('t1').classList.remove('active');
    document.getElementById('t2').classList.remove('active');
    document.getElementById('t3').classList.remove('active');

    // á€¡á€á€¯á€”á€¾á€­á€•á€ºá€œá€­á€¯á€€á€ºá€á€²á€· Tab á€”á€²á€· Section á€€á€­á€¯á€•á€² á€•á€¼á€”á€ºá€–á€±á€¬á€ºá€™á€šá€º
    if(t === 'upload') {
        document.getElementById('uploadSection').classList.remove('hidden');
        document.getElementById('t1').classList.add('active');
    } else if(t === 'orders') {
        document.getElementById('orderSection').classList.remove('hidden');
        document.getElementById('t2').classList.add('active');
        // Tab á€•á€¼á€±á€¬á€„á€ºá€¸á€œá€­á€¯á€€á€ºá€á€¬á€”á€²á€· á€¡á€±á€¬á€ºá€’á€«á€á€½á€±á€€á€­á€¯ á€á€»á€€á€ºá€á€»á€„á€ºá€¸á€†á€½á€²á€šá€°á€á€­á€¯á€„á€ºá€¸á€™á€šá€º
        syncData(); 
    } else if(t === 'manage') {
        document.getElementById('manageSection').classList.remove('hidden');
        document.getElementById('t3').classList.add('active');
    }
}


        syncData();
    </script>
</body>
</html>

