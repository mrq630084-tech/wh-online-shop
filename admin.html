<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WH á€…á€®á€™á€¶á€á€”á€·á€ºá€á€½á€²á€á€°</title>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <style>
        :root { --main: #00ff88; --glass: rgba(255, 255, 255, 0.05); }
        body { background: #0a0e17; color: white; font-family: sans-serif; margin: 0; padding: 15px; }
        
        /* Password á€™á€»á€€á€ºá€”á€¾á€¬á€•á€¼á€„á€º */
        #loginOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #0a0e17; display: flex; align-items: center; justify-content: center; z-index: 1000; }
        .login-card { background: var(--glass); padding: 30px; border-radius: 30px; border: 1px solid rgba(255,255,255,0.1); backdrop-filter: blur(15px); text-align: center; width: 85%; }
        
        /* Custom Alert á€’á€®á€‡á€­á€¯á€„á€ºá€¸ */
        .custom-alert { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2000; align-items: center; justify-content: center; }
        .alert-box { background: #1a1f2b; padding: 25px; border-radius: 25px; border: 1px solid var(--main); text-align: center; width: 80%; }
        
        /* Admin á€’á€®á€‡á€­á€¯á€„á€ºá€¸á€™á€»á€¬á€¸ */
        .admin-content { display: none; }
        .tab-box { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab-btn { flex: 1; padding: 15px; border: none; border-radius: 15px; background: var(--glass); color: #aaa; font-weight: bold; }
        .tab-btn.active { background: var(--main); color: #000; }
        .section { background: var(--glass); padding: 20px; border-radius: 25px; border: 1px solid rgba(255,255,255,0.1); display: none; }
        .section.active { display: block; }
        input { width: 100%; padding: 15px; margin: 10px 0; border-radius: 15px; border: 1px solid #333; background: rgba(0,0,0,0.3); color: white; box-sizing: border-box; }
        .btn { width: 100%; padding: 15px; border-radius: 15px; border: none; font-weight: bold; margin-top: 10px; }
        .add-btn { background: var(--main); color: #000; }
        .del-btn { background: #ff4444; color: white; padding: 8px 15px; border-radius: 10px; border:none; cursor:pointer; }
        .item-card { background: rgba(255,255,255,0.03); border: 1px solid #222; padding: 15px; border-radius: 15px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; }
    </style>
</head>
<body>

    <div id="loginOverlay">
        <div class="login-card">
            <h2 style="color: var(--main);">á€œá€»á€¾á€­á€¯á€·á€á€¾á€€á€ºá€”á€¶á€•á€«á€á€º</h2>
            <input type="password" id="pwInput" placeholder="á€›á€­á€¯á€€á€ºá€‘á€Šá€·á€ºá€•á€«...">
            <button class="btn add-btn" onclick="checkPw()">á€¡á€á€Šá€ºá€•á€¼á€¯á€™á€Šá€º</button>
        </div>
    </div>

    <div id="customAlert" class="custom-alert">
        <div class="alert-box">
            <p id="alertMsg" style="font-size: 1.1rem; margin-bottom: 20px;"></p>
            <div id="alertBtns" style="display: flex; gap: 10px;"></div>
        </div>
    </div>

    <div class="admin-content" id="adminPanel">
        <h2 style="text-align: center; color: var(--main);">WH á€…á€®á€™á€¶á€á€”á€·á€ºá€á€½á€²á€á€°</h2>
        <div class="tab-box">
            <button id="b1" class="tab-btn active" onclick="showTab('upload')">á€•á€…á€¹á€…á€Šá€ºá€¸á€á€„á€º/á€–á€»á€€á€º</button>
            <button id="b2" class="tab-btn" onclick="showTab('orders')">á€¡á€±á€¬á€ºá€’á€«á€™á€»á€¬á€¸</button>
        </div>

        <div id="upload" class="section active">
            <input type="text" id="pName" placeholder="á€•á€…á€¹á€…á€Šá€ºá€¸á€¡á€™á€Šá€º">
            <input type="number" id="pPrice" placeholder="á€ˆá€±á€¸á€”á€¾á€¯á€”á€ºá€¸">
            <input type="text" id="pImg" placeholder="á€•á€¯á€¶á€œá€„á€·á€ºá€á€º">
            <button class="btn add-btn" onclick="uploadProduct()">á€•á€…á€¹á€…á€Šá€ºá€¸á€¡á€á€…á€ºá€á€„á€ºá€™á€Šá€º</button>
            <hr style="opacity:0.1; margin: 20px 0;">
            <div id="adminProductList">á€†á€½á€²á€šá€°á€”á€±á€á€Šá€º...</div>
        </div>

        <div id="orders" class="section">
            <div id="adminOrderList">á€¡á€±á€¬á€ºá€’á€«á€™á€»á€¬á€¸ á€†á€½á€²á€šá€°á€”á€±á€á€Šá€º...</div>
        </div>
    </div>

    <script>
        const correctPw = "131019";
        const firebaseConfig = {
            apiKey: "AIzaSyBU4Q9G2eyigNWyZVT_dabEFG4fuslwTW4",
            authDomain: "online-shop-wh.firebaseapp.com",
            projectId: "online-shop-wh",
            storageBucket: "online-shop-wh.firebasestorage.app",
            messagingSenderId: "297839145890",
            appId: "1:297839145890:web:f90f862b000e8631a4f8fb"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        function myAlert(msg, type, onConfirm) {
            const box = document.getElementById('customAlert');
            document.getElementById('alertMsg').innerText = msg;
            const btnArea = document.getElementById('alertBtns');
            btnArea.innerHTML = "";
            if(type === 'confirm') {
                btnArea.innerHTML = `
                    <button class="btn" style="background:#444; color:white;" onclick="closeAlert()">á€™á€œá€¯á€•á€ºá€á€±á€¬á€·á€•á€«</button>
                    <button class="btn add-btn" id="confirmBtn">á€á€±á€á€»á€¬á€á€Šá€º</button>`;
                document.getElementById('confirmBtn').onclick = function() { onConfirm(); closeAlert(); };
            } else {
                btnArea.innerHTML = `<button class="btn add-btn" onclick="closeAlert()">á€€á€±á€¬á€„á€ºá€¸á€•á€«á€•á€¼á€®</button>`;
            }
            box.style.display = 'flex';
        }

        function closeAlert() { document.getElementById('customAlert').style.display = 'none'; }

        function checkPw() {
            if(document.getElementById('pwInput').value === correctPw) {
                document.getElementById('loginOverlay').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
            } else { myAlert("á€œá€»á€¾á€­á€¯á€·á€á€¾á€€á€ºá€”á€¶á€•á€«á€á€º á€™á€¾á€¬á€¸á€šá€½á€„á€ºá€¸á€”á€±á€•á€«á€á€Šá€ºá‹", "ok"); }
        }

        function uploadProduct() {
            const name = document.getElementById('pName').value;
            const price = document.getElementById('pPrice').value;
            const img = document.getElementById('pImg').value;
            if(name && price && img) {
                db.collection("products").add({ name, price, image_url: img.trim() })
                .then(() => { myAlert("á€•á€…á€¹á€…á€Šá€ºá€¸á€á€„á€ºá€á€¼á€„á€ºá€¸ á€¡á€±á€¬á€„á€ºá€™á€¼á€„á€ºá€•á€«á€á€Šá€ºá‹", "ok", () => location.reload()); });
            }
        }

        db.collection("products").onSnapshot((snapshot) => {
            let html = "";
            snapshot.forEach((doc) => {
                let p = doc.data();
                html += `<div class="item-card">
                    <div><strong>${p.name}</strong><br><small>${p.price} á€€á€»á€•á€º</small></div>
                    <button class="del-btn" onclick="askDelete('products','${doc.id}')">á€–á€»á€€á€ºá€™á€Šá€º</button>
                </div>`;
            });
            document.getElementById('adminProductList').innerHTML = html;
        });

        db.collection("orders").orderBy("time", "desc").onSnapshot((snapshot) => {
            let html = "";
            snapshot.forEach((doc) => {
                let o = doc.data();
                html += `<div class="item-card">
                    <div><strong>ğŸ“¦ ${o.product}</strong><br><small>ğŸ‘¤ ${o.customer}</small></div>
                    <button class="del-btn" style="background:#64748b" onclick="askDelete('orders','${doc.id}')">á€–á€»á€€á€ºá€™á€Šá€º</button>
                </div>`;
            });
            document.getElementById('adminOrderList').innerHTML = html || "á€¡á€±á€¬á€ºá€’á€«á€™á€›á€¾á€­á€á€±á€¸á€•á€«á‹";
        });

        function askDelete(col, id) {
            myAlert("á€¤á€¡á€›á€¬á€€á€­á€¯ á€–á€»á€€á€ºá€›á€”á€º á€á€±á€á€»á€¬á€•á€«á€á€œá€¬á€¸ á€†á€›á€¬?", "confirm", () => {
                db.collection(col).doc(id).delete();
            });
        }

        function showTab(tabId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            if(tabId === 'upload') document.getElementById('b1').classList.add('active');
            else document.getElementById('b2').classList.add('active');
        }
    </script>
</body>
</html>
